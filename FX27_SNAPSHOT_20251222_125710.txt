=== FX27 SNAPSHOT ===
DATE: 12/22/2025 12:57:10
USER: jj27\timon
PATH: C:\Users\timon\Downloads\izzi_sync

--- NODE/NPM ---
v24.11.0
11.6.1

--- GIT ---
origin	https://github.com/vivercan/izzi.git (fetch)
origin	https://github.com/vivercan/izzi.git (push)
main
## main...origin/main
 ? archivosjjdescomprimidos
?? FX27_SNAPSHOT_20251222_125710.txt

LAST 10 COMMITS:
3adbb1d4 fix: Auto-refresh sin boton actualizar
ac8d0d7e fix: Sin logo duplicado, dise‚îú‚ñío compacto final
3fe59a9b fix: Dise‚îú‚ñío compacto sin logo duplicado
4c3137e3 fix: Geocoding para ubicaciones + columnas MTTO Origen Destino
c4884487 fix: Encabezados tabla Despacho Inteligente
02643c1e fix: Carroll muestra ubicacion legible y estados correctos
4b84e2d6 fix: Solo un indicador de cron limpio
d42f5188 fix: Carroll lee de gps_tracking + hora cron correcta
fa4c5c3c fix: Hora correcta del cron + countdown en tiempo real
87a3cb8e fix(carroll): Version simplificada sin crash

--- FX27 FILES ---

Name                               LastWriteTime
----                               -------------
AdminCarrollModule.tsx             13/12/2025 12:41:14 p. m.
AdministracionCarroll.tsx          13/12/2025 12:41:14 p. m.
AgregarLeadModule_LIGHT.tsx        13/12/2025 12:41:14 p. m.
AgregarLeadModule.tsx              14/12/2025 01:01:12 a. m.
AIAssistant.tsx                    27/11/2025 11:42:43 a. m.
AutocompleteInput.tsx              27/11/2025 11:42:43 a. m.
Button.tsx                         27/11/2025 11:42:43 a. m.
CarrollConfigModule.tsx            27/11/2025 11:42:43 a. m.
CarrollModule.tsx                  13/12/2025 12:41:14 p. m.
CarrollModuleFinal.tsx             19/12/2025 01:26:33 a. m.
CarrollModuleFinalV2.tsx           27/11/2025 11:42:43 a. m.
CarrollModuleFinalV2Compact.tsx    13/12/2025 12:41:14 p. m.
CatalogoFormatosVenta.tsx          13/12/2025 12:41:14 p. m.
ConfiguracionModule.tsx            27/11/2025 11:42:43 a. m.
ControlEquipoModule.tsx            27/11/2025 11:42:43 a. m.
CotizacionesModule.tsx             27/11/2025 11:42:43 a. m.
DashboardCard.tsx                  27/11/2025 11:42:43 a. m.
DashboardScreen.tsx                27/11/2025 11:42:43 a. m.
DashboardWidgets.tsx               27/11/2025 11:42:43 a. m.
DedicadosHub.tsx                   13/12/2025 12:41:14 p. m.
DedicadosModule.tsx                13/12/2025 12:41:14 p. m.
DedicadosModuleWideTech.tsx        19/12/2025 12:02:14 p. m.
DespachoInteligenteContent.tsx     21/12/2025 11:29:18 a. m.
DespachoInteligenteModule.tsx      18/12/2025 02:00:48 p. m.
EjemploUbicacionesInteligentes.tsx 27/11/2025 11:42:43 a. m.
EjemploUbicacionGPS.tsx            27/11/2025 11:42:43 a. m.
FormatosVentaHub.tsx               13/12/2025 12:41:14 p. m.
Input.tsx                          27/11/2025 11:42:43 a. m.
KPIsModule.tsx                     27/11/2025 11:42:43 a. m.
LoginScreen.tsx                    13/12/2025 03:17:07 p. m.
MapaClim aticoCarroll.tsx          27/11/2025 11:42:43 a. m.
MapaClimaticoCarroll.tsx           27/11/2025 11:42:43 a. m.
MapaFlota.tsx                      27/11/2025 11:42:43 a. m.
MapaFlotaGoogleMaps.tsx            27/11/2025 11:42:43 a. m.
ModuleTemplate.tsx                 13/12/2025 03:17:05 p. m.
NewsTicker.tsx                     27/11/2025 11:42:43 a. m.
NuevoFormatoVenta.tsx              13/12/2025 12:41:14 p. m.
PanelOportunidadesModule.tsx       17/12/2025 12:21:17 p. m.
ServicioClientesModule.tsx         27/11/2025 11:42:43 a. m.
UbicacionDetallada.tsx             27/11/2025 11:42:43 a. m.
UbicacionGPS.tsx                   27/11/2025 11:42:43 a. m.
UbicacionInteligenteCompacta.tsx   27/11/2025 11:42:43 a. m.
UsuariosModule.tsx                 13/12/2025 12:41:14 p. m.
UtileriasModule.tsx                27/11/2025 11:42:43 a. m.
VariablesCotizacionModule.tsx      27/11/2025 11:42:43 a. m.
VentasModule.tsx                   17/12/2025 06:16:00 p. m.
VerificadorGoogleMapsAPI.tsx       27/11/2025 11:42:43 a. m.
VistaClientesCarroll.tsx           13/12/2025 12:41:14 p. m.



--- APP.TSX (solo l√≠neas clave) ---
2: import { LoginScreen } from './components/fx27/LoginScreen';
5: import { PanelOportunidadesModule } from './components/fx27/PanelOportunidadesModule';
12: import { VentasModule } from './components/fx27/VentasModule';
14: import { ServicioClientesModule } from './components/fx27/ServicioClientesModule';
15: import { DedicadosModuleWideTech } from './components/fx27/DedicadosModuleWideTech';
27: // üìã MATRIZ COMPLETA DE USUARIOS FX27 - ACTUALIZADA 17/DIC/2025
55:   permisosCustom?: string[];
61: // üîí 9 USUARIOS AUTORIZADOS
62: const USUARIOS_AUTORIZADOS: Usuario[] = [
186:   const [userPermisosCustom, setUserPermisosCustom] = useState<string[]>([]);
189:   const [currentUserEmail, setCurrentUserEmail] = useState<string>('');
194:     // Siempre actualizar usuarios
195:     localStorage.setItem('fx27-usuarios', JSON.stringify(USUARIOS_AUTORIZADOS));
201:         const usuario = USUARIOS_AUTORIZADOS.find(u => u.correo === session.email && u.activo);
208:           setUserPermisosCustom(usuario.permisosCustom || []);
209:           setCurrentUserEmail(session.email);
226:     const usuario = USUARIOS_AUTORIZADOS.find(u => 
243:     setUserPermisosCustom(usuario.permisosCustom || []);
245:     setCurrentUserEmail(email);
253:       permisosCustom: usuario.permisosCustom || [],
260:     fetch(`https://${projectId}.supabase.co/functions/v1/make-server-d84b50bb/usuarios/ultimo-acceso`, {
274:     setUserPermisosCustom([]);
275:     setCurrentUserEmail('');
281:     if (!checkModuleAccess(module, userRole, userPermisosCustom)) {
282:       alert('‚ö†Ô∏è Acceso Restringido\n\nNo tienes permisos para este m√≥dulo.');
290:   // üîí PERMISOS POR ROL
291:   const checkModuleAccess = (module: string, role: UserRole, permisosCustom: string[] = []): boolean => {
298:     if (role === 'custom') return permisosCustom.includes(module);
305:         <LoginScreen onLogin={handleLogin} loginError={loginError} />
310:             <PanelOportunidadesModule 
321:           {currentModule === 'ventas' && <VentasModule onBack={handleBack} />}
323:           {currentModule === 'servicio-clientes' && <ServicioClientesModule onBack={handleBack} />}
328:           {currentModule === 'monitor-carroll' && <DedicadosModuleWideTech onBack={() => setCurrentModule('dedicados')} />}

--- VentasModule (permisos + filtros + columna usada) ---
8: // üìã PERMISOS DE USUARIOS - ACTUALIZADOS 18/DIC/2025
10: const PERMISOS: { [email: string]: { vendedor?: string; verTodo: boolean } } = {
12:   'juan.viveros@trob.com.mx': { verTodo: true },
13:   'jennifer.sanchez@trob.com.mx': { verTodo: true },
15:   'customer.service3@trob.com.mx': { verTodo: true },  // Lizeth Rodr√≠guez
16:   'customer.service1@trob.com.mx': { verTodo: true },  // Elizabeth Rodr√≠guez
18:   'isis.estrada@wexpress.com.mx': { vendedor: 'ISIS', verTodo: false },
19:   'paloma.oliva@speedyhaul.com.mx': { vendedor: 'PALOMA', verTodo: false },
98:   // Obtener permisos del usuario
100:     const permiso = PERMISOS[userEmail.toLowerCase()];
101:     if (!permiso) return { verTodo: true }; // Default: admin
105:   const vendedorFiltro = permisoUsuario.vendedor || '';
106:   const esAdmin = permisoUsuario.verTodo;
112:       let query = supabase.from('ventas_maestro').select('*').eq('year', year);
114:       // üîê Filtro por vendedor (ISIS/PALOMA solo ven sus clientes)
115:       if (!esAdmin && vendedorFiltro) {
116:         query = query.eq('vendedor', vendedorFiltro);
120:       if (filtros.segmento) query = query.eq('segmento', filtros.segmento);
121:       if (filtros.tipo) query = query.eq('tipo', filtros.tipo);
122:       if (filtros.empresa) query = query.eq('empresa', filtros.empresa);
174:   }, [year, filtros, esAdmin, vendedorFiltro]);
221: Usuario: ${userEmail} (${esAdmin ? 'Admin - ve todo' : `Vendedor ${vendedorFiltro} - solo sus clientes`})
309:       {/* Info vendedor (solo si no es admin) */}
310:       {!esAdmin && vendedorFiltro && (
314:             <span className="text-sm">Mostrando solo clientes asignados a <strong>{vendedorFiltro}</strong></span>
425:     <ModuleTemplate title="Ventas" subtitle={esAdmin ? "Dashboard General" : `Clientes ${vendedorFiltro}`} onBack={onBack} backgroundImage={MODULE_IMAGES.ventas}>

--- PanelOportunidadesModule (permisos) ---
11: // üìã PERMISOS OPORTUNIDADES - userVendedorLeads viene desde App.tsx
13: // | Usuario            | userVendedorLeads | Leads que ve                    |
19: // | Isis Estrada       | 'Isis Estrada'    | Solo leads donde vendedor match  |
20: // | Paloma Oliva       | 'Paloma Oliva'    | Solo leads donde vendedor match  |
26:   userVendedorLeads?: string; // 'Isis Estrada' | 'Paloma Oliva' | '' (admin/csr ve todo)
29: interface Cotizacion { nombre: string; url: string; fecha: string; analisis?: any; eliminado?: boolean; lineas?: LineaCotizacion[]; potencialMXN?: number; }
32: interface Lead { id: string; nombreEmpresa: string; paginaWeb: string; nombreContacto: string; telefonoContacto?: string; correoElectronico: string; tipoServicio: string[]; tipoViaje: string[]; principalesRutas: string; viajesPorMes: string; tarifa: string; proyectadoVentaMensual?: string; proximosPasos: string; etapaLead?: string; altaCliente?: boolean; generacionSOP?: boolean; juntaArranque?: boolean; facturado?: boolean; vendedor: string; fechaCaptura?: string; fechaActualizacion?: string; cotizaciones?: Cotizacion[]; eliminado?: boolean; fechaEliminado?: string; historial?: HistorialCambio[]; fechaLiberacion?: string; holdInfo?: HoldInfo; declinado?: boolean; fechaDeclinado?: string; }
33: type SortField = 'nombreEmpresa' | 'vendedor' | 'fechaCaptura' | 'viajesPorMes';
106:     console.log('Enviando a Edge Function para analisis con Claude Vision...');
127:     const response = await fetch(`https://fbxbsslhewchyibdoyzk.supabase.co/functions/v1/analizar-cotizacion-pdf`, { method: 'POST', headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${publicAnonKey}` }, body: JSON.stringify({ imagenBase64, textoPDF }) });
165: // Detecta: cliente existente, lead de otro vendedor, lead propio, similares
168:   esLeadOtroVendedor: boolean;
169:   vendedorActual: string;
172:   similares: { nombre: string; tipo: 'cliente' | 'lead'; vendedor?: string }[];
178:   vendedorActual: string
185:   // 2. Verificar si es lead de otro vendedor
186:   const leadOtroVendedor = todosLosLeads.find(l => 
188:     l.vendedor !== vendedorActual &&
195:     l.vendedor === vendedorActual &&
200:   const similares: { nombre: string; tipo: 'cliente' | 'lead'; vendedor?: string }[] = [];
211:   // Similares en leads (de cualquier vendedor)
219:           vendedor: l.vendedor 
227:     esLeadOtroVendedor: !!leadOtroVendedor,
228:     vendedorActual: leadOtroVendedor?.vendedor || '',
230:     duplicadoExacto: esClienteExistente || !!leadOtroVendedor || !!leadPropio,
255: export const PanelOportunidadesModule = ({ onBack, userVendedorLeads }: PanelOportunidadesModuleProps) => {
261:   const [filterVendedor, setFilterVendedor] = useState('');
263:   const [funnelVendedor, setFunnelVendedor] = useState(''); // Filtro de vendedor para Funnel
264:   const [vendedorActual, setVendedorActual] = useState(''); // Nombre del vendedor logueado
275:   const [puedeVerTodo, setPuedeVerTodo] = useState(false); // Admin o CSR ve todo
292:         let vendedor = '', esAdmin = false, esCsr = false;
298:             vendedor = usuario.nombre; 
302:             setPuedeVerTodo(esAdmin || esCsr);
303:             setVendedorActual(vendedor);
308:         console.log('   ‚Üí userVendedorLeads:', userVendedorLeads || 'VER TODO');
313:         const response = await fetch(url, { headers: { 'Authorization': `Bearer ${publicAnonKey}` } });
320:           // Si userVendedorLeads tiene valor, filtrar por nombre de vendedor
321:           if (userVendedorLeads && userVendedorLeads.trim() !== '') {
322:             console.log('üîí Filtrando leads para:', userVendedorLeads);
324:               const vendedorLead = (l.vendedor || '').toLowerCase().trim();
325:               const filtro = userVendedorLeads.toLowerCase().trim();
326:               // Comparar si el vendedor del lead contiene o es igual al filtro
327:               return vendedorLead === filtro || vendedorLead.includes(filtro);
332:           // Si no tiene userVendedorLeads y no es admin/csr, filtrar por su nombre
333:           else if (!esAdmin && !esCsr && vendedor) {
334:             console.log('üîí Filtrando por nombre de usuario:', vendedor);
336:               (l.vendedor || '').toLowerCase().trim() === vendedor.toLowerCase().trim()
356:   }, [userVendedorLeads]);
383:   const esLeadDuplicado = (lead: Lead): { esDuplicado: boolean; cantidad: number; otrosVendedores: string[] } => {
392:     const otrosVendedores = [...new Set(duplicados.map(l => l.vendedor).filter(v => v !== lead.vendedor))];
397:       otrosVendedores
432:               headers: { 'Authorization': `Bearer ${publicAnonKey}`, 'Content-Type': 'application/json' },
456:     // Filtrar seg√∫n permisos
471:     if (filterVendedor) resultado = resultado.filter(lead => lead.vendedor === filterVendedor);
475:   }, [leads, searchTerm, filterVendedor, filterFecha, sortField, sortDirection, showDeleted, isAdmin]);
488:   const handleExportExcel = () => { const headers = ['Empresa', 'Contacto', 'Email', 'Servicio', 'Viaje', 'Rutas', 'Viajes/Mes', 'Potencial MXN', 'Vendedor', 'Fecha']; const rows = filteredLeads.map(lead => { const potencial = calcularPotencialDesdeCotizaciones(lead); return [lead.nombreEmpresa, lead.nombreContacto, lead.correoElectronico, (lead.tipoServicio||[]).join(', '), (lead.tipoViaje||[]).join(', '), lead.principalesRutas, lead.viajesPorMes, potencial > 0 ? `$${potencial.toLocaleString('es-MX')}` : '', lead.vendedor, formatDate(lead.fechaCaptura)]; }); const csvContent = [headers.join(','), ...rows.map(row => row.map(cell => `"${cell}"`).join(','))].join('\n'); const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' }); const link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = `leads_fx27_${new Date().toISOString().split('T')[0]}.csv`; link.click(); };
489:   const getVendedoresUnicos = () => Array.from(new Set(leads.map(lead => lead.vendedor)));
576:     const historialNuevo: HistorialCambio = { fecha: new Date().toISOString(), campo: 'cotizaciones', valorAnterior: '', valorNuevo: `Nueva cotizacion: ${cotizaciones[index].nombre}`, usuario: lead.vendedor };
579:       await fetch(`https://${projectId}.supabase.co/functions/v1/make-server-d84b50bb/leads/${lead.id}`, { method: 'PUT', headers: { 'Authorization': `Bearer ${publicAnonKey}`, 'Content-Type': 'application/json' }, body: JSON.stringify(leadActualizado) });
586:   const handleEliminarCotizacion = async (lead: Lead, index: number) => { const cotizaciones = lead.cotizaciones?.map((c, i) => i === index ? { ...c, eliminado: true } : c) || []; const potencialTotal = cotizaciones.filter(c => !c.eliminado && c.potencialMXN).reduce((sum, c) => sum + (c.potencialMXN || 0), 0); const leadActualizado = { ...lead, cotizaciones, proyectadoVentaMensual: potencialTotal > 0 ? `$${potencialTotal.toLocaleString('es-MX')} MXN` : '', fechaActualizacion: new Date().toISOString() }; try { await fetch(`https://${projectId}.supabase.co/functions/v1/make-server-d84b50bb/leads/${lead.id}`, { method: 'PUT', headers: { 'Authorization': `Bearer ${publicAnonKey}`, 'Content-Type': 'application/json' }, body: JSON.stringify(leadActualizado) }); setLeads(leads.map(l => l.id === lead.id ? leadActualizado : l)); setCotizacionesModal(leadActualizado); } catch { alert('Error'); } };
587:   const handleConfirmarEliminacion = async () => { if (!deleteModal || deleteConfirmText !== 'DELETE') return; try { const leadActualizado = { ...deleteModal, eliminado: true, fechaEliminado: new Date().toISOString() }; await fetch(`https://${projectId}.supabase.co/functions/v1/make-server-d84b50bb/leads/${deleteModal.id}`, { method: 'PUT', headers: { 'Authorization': `Bearer ${publicAnonKey}`, 'Content-Type': 'application/json' }, body: JSON.stringify(leadActualizado) }); setLeads(leads.map(l => l.id === deleteModal.id ? leadActualizado : l)); setDeleteModal(null); setDeleteConfirmText(''); } catch { alert('Error'); } };
588:   const handleRestaurarLead = async (lead: Lead) => { if (!isAdmin) return; try { const leadActualizado = { ...lead, eliminado: false, fechaEliminado: null }; await fetch(`https://${projectId}.supabase.co/functions/v1/make-server-d84b50bb/leads/${lead.id}`, { method: 'PUT', headers: { 'Authorization': `Bearer ${publicAnonKey}`, 'Content-Type': 'application/json' }, body: JSON.stringify(leadActualizado) }); setLeads(leads.map(l => l.id === lead.id ? leadActualizado : l)); } catch {} };
601:       const duplicados = buscarDuplicadosCompleto(nombreNuevo, allLeads, vendedorActual);
609:       // 2. Es lead de otro vendedor
610:       if (duplicados.esLeadOtroVendedor) {
611:         alert(`‚ùå ERROR: "${nombreNuevo}" ya es un lead asignado a ${duplicados.vendedorActual}.\n\nNo se permiten leads duplicados entre vendedores.`);
620:             : `‚Ä¢ ${s.nombre} (Lead de ${s.vendedor})`
630:       const historialNuevo: HistorialCambio = { fecha: new Date().toISOString(), campo: 'edicion', valorAnterior: editLead.nombreEmpresa, valorNuevo: formData.nombreEmpresa || '', usuario: editLead.vendedor };
632:       await fetch(`https://${projectId}.supabase.co/functions/v1/make-server-d84b50bb/leads/${editLead.id}`, { method: 'PUT', headers: { 'Authorization': `Bearer ${publicAnonKey}`, 'Content-Type': 'application/json' }, body: JSON.stringify(leadActualizado) });
792:                       `‚Ä¢ ${nombre}: ${leads.length} registros (${leads.map(l => l.vendedor).join(', ')})`
839:             {/* FILTRO VENDEDOR - Select premium */}
842:                 value={filterVendedor} 
843:                 onChange={(e) => setFilterVendedor(e.target.value)} 
852:                 <option value="">Todos los vendedores</option>
853:                 {getVendedoresUnicos().map(v => <option key={v} value={v}>{v}</option>)}
917:         {/* FUNNEL CARD - Premium glass con filtro por vendedor */}
931:                 Funnel de Ventas {!isAdmin && <span className="text-blue-400/70 text-sm ml-2">({vendedorActual})</span>}
933:               {/* Filtro de vendedor - Solo Admin */}
936:                   value={funnelVendedor} 
937:                   onChange={(e) => setFunnelVendedor(e.target.value)} 
944:                   <option value="">Todos los vendedores</option>
945:                   {getVendedoresUnicos().map(v => <option key={v} value={v}>{v}</option>)}
949:             {/* M√©tricas del Funnel - Filtradas seg√∫n vendedor */}
953:                 ? (funnelVendedor ? leads.filter(l => l.vendedor === funnelVendedor) : leads)
954:                 : leads.filter(l => l.vendedor === vendedorActual);
1037:                 <th onClick={() => handleSort('vendedor')} className="px-3 py-3.5 text-left cursor-pointer hover:text-white transition-colors" style={{ fontSize: '11px', fontWeight: 600, color: 'rgba(180,190,205,0.95)', letterSpacing: '0.06em' }}><div className="flex items-center gap-1"><User className="w-3 h-3" />VENDEDOR<SortIcon field="vendedor" /></div></th>
1126:                                     title={`‚ö†Ô∏è DUPLICADO: Este lead aparece ${dupInfo.cantidad} veces${dupInfo.otrosVendedores.length > 0 ? `\nOtros vendedores: ${dupInfo.otrosVendedores.join(', ')}` : '\n(mismo vendedor)'}`}
1360:                       {/* VENDEDOR */}
1361:                       <td className="px-3 py-2" style={{ fontSize: '11px', color: 'rgba(148,163,184,0.90)' }}>{lead.vendedor}</td>
1455:       {selectedLead && (<div className="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4" onClick={() => setSelectedLead(null)}><div className="bg-slate-900 rounded-2xl border border-slate-700/40 w-[95vw] max-w-[1100px] max-h-[90vh] overflow-y-auto p-6" onClick={(e) => e.stopPropagation()}><div className="flex items-center justify-between mb-4"><h3 className="text-white text-xl font-bold flex items-center gap-2"><Building2 className="w-6 h-6 text-blue-400" />{selectedLead.nombreEmpresa}</h3><button onClick={() => setSelectedLead(null)} className="p-2 rounded-lg hover:bg-slate-800 transition-colors"><X className="w-5 h-5 text-white" /></button></div><div className="grid grid-cols-2 gap-4 mb-4"><div className="p-3 rounded-lg bg-blue-500/5 border border-blue-500/15"><div className="flex items-center gap-2 text-blue-400/70 text-xs mb-1"><Calendar className="w-3 h-3" />Creacion</div><div className="text-white font-semibold">{formatDateTime(selectedLead.fechaCaptura)}</div></div><div className="p-3 rounded-lg bg-orange-500/5 border border-orange-500/15"><div className="flex items-center gap-2 text-orange-400/70 text-xs mb-1"><Clock className="w-3 h-3" />Ultima Modificacion</div><div className="text-white font-semibold">{formatDateTime(selectedLead.fechaActualizacion) || formatDateTime(selectedLead.fechaCaptura)}</div></div></div><div className="grid grid-cols-3 gap-4 text-sm mb-4"><div className="p-3 rounded-lg bg-slate-800/40 border border-slate-700/25"><div className="text-blue-400/70 text-xs mb-1">Contacto</div><div className="text-white font-semibold">{selectedLead.nombreContacto}</div><div className="text-slate-400">{selectedLead.correoElectronico}</div></div><div className="p-3 rounded-lg bg-slate-800/40 border border-slate-700/25"><div className="text-blue-400/70 text-xs mb-1">Servicio</div><div className="flex flex-wrap gap-1">{(selectedLead.tipoServicio||[]).map((t,i)=><span key={i} className="px-2 py-0.5 rounded bg-slate-700/40 text-slate-300 text-xs border border-slate-600/25">{t}</span>)}</div></div><div className="p-3 rounded-lg bg-slate-800/40 border border-slate-700/25"><div className="text-blue-400/70 text-xs mb-1">Viaje</div><div className="flex flex-wrap gap-1">{(selectedLead.tipoViaje||[]).map((t,i)=><span key={i} className="px-2 py-0.5 rounded bg-blue-500/10 text-blue-300 text-xs border border-blue-500/20">{t}</span>)}</div></div><div className="p-3 rounded-lg bg-slate-800/40 border border-slate-700/25 col-span-2"><div className="text-blue-400/70 text-xs mb-1">Rutas</div><div className="text-white text-sm">{selectedLead.principalesRutas || '-'}</div></div><div className="p-3 rounded-lg bg-slate-800/40 border border-slate-700/25"><div className="text-blue-400/70 text-xs mb-1">Viajes/Mes</div><div className="text-white font-bold text-lg">{selectedLead.viajesPorMes || '-'}</div></div></div>{(() => { const pot = calcularPotencialDesdeCotizaciones(selectedLead); return pot > 0 ? <div className="p-4 rounded-lg bg-teal-500/5 border border-teal-500/15 mb-4"><div className="text-teal-400/70 text-xs mb-1">$ Potencial Mensual</div><div className="text-teal-400 font-bold text-3xl">${pot.toLocaleString('es-MX')} MXN</div></div> : null; })()}<div className="flex justify-between items-center text-sm text-slate-500"><span>Vendedor: {selectedLead.vendedor}</span><span>Etapa: {selectedLead.etapaLead || 'Prospecto'}</span></div></div></div>)}
1641:                         // Liberar lead (quitar vendedor)
1645:                           vendedor: '',

DONE. Archivo generado:
C:\Users\timon\Downloads\izzi_sync\FX27_SNAPSHOT_20251222_125710.txt
